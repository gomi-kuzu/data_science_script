x = 28
y = 28
library(EBImage)
img = readImage("~/Pictures/pallet.jpg")
display(img)
re.img = resize(img,x,y)
WD.img = 1 - re.img
display(img)
rev.img = 1 - re.img
display(rev.img)
in.img = data.matrix(WD.img)
dim(in.img) = c(x,y,1,1)
new.preds = predict(model,in.img , ctx=mx.cpu())
CNNM = mx.model.load("CNNmodel",30) #これやればモデルがロードできる
CNNM = mx.model.load("../CNNmodel",30) #これやればモデルがロードできる
CNNM = mx.model.load("../CNNmodel",30) #これやればモデルがロードできる
library(mxnet)
library(mxnet)
CNNM = mx.model.load("../CNNmodel",30) #これやればモデルがロードできる
new.preds = predict(CNNM,in.img , ctx=mx.cpu())
cat(max.col(t(new.preds)) - 1)
x = 28
y = 28
library(EBImage)
img = readImage("~/Pictures/pallet.jpg")
re.img = resize(img,x,y)
rev.img = 1 - re.img
in.img = data.matrix(rev.img)
dim(in.img) = c(x,y,1,1)
CNNM = mx.model.load("../CNNmodel",30)
library(mxnet)
CNNM = mx.model.load("../CNNmodel",30)
model = mx.model.load("../CNNmodel",30)
new.preds = predict(model,in.img , ctx=mx.cpu())
cat(max.col(t(new.preds)) - 1)
data(iris)
num<-sample(nrow(iris),30)#データ量が多いのでサンプリング
sampleData<-iris[num,]
sampleData
Nresidual<-k-nrow(sampleData)%%k
k=7
Nresidual<-k-nrow(sampleData)%%k
Nresidual
sampleNum<-sample(nrow(wine),30)
wine=read.csv("../rep_4/labeled_wine.csv",header = T,fileEncoding = "SJIS")
nrow(wine)
k-nrow(wine)
k-nrow(wine)%%k
k
30%%7
wine=read.csv("../rep_4/labeled_wine.csv",header = T,fileEncoding = "SJIS")
Nresidual<-k-nrow(sampleData)%%k
dummyData<-as.data.frame(matrix(NA,nrow=Nresidual,ncol=ncol(sampleData)))
names(dummyData)<-names(sampleData)
sampleData<-rbind(sampleData,dummyData)
splitData<-split(sampleData,1:k)
sampleData
k = 5
Nresidual<-k-nrow(wine)%%k
dummyData<-as.data.frame(matrix(NA,nrow=Nresidual,ncol=ncol(wine)))
dummyData
Nresidual
names(dummyData)<-names(wine)
Nresidual
dummyData
new.wine<-rbind(wine,dummyData)
splitData<-split(new.wine,1:k)
splitData
splitData[5]
dim(splitData)
dim(splitData[5])
nrow(splitData[5])
nrow(splitData[4])
(splitData[4])
length(splitData)
length(splitData[5])
type(splitData[5])
class(splitData)
class(splitData[5])
a=splitData[5]
length(a)
a
rm(list = ls(all.names = TRUE))
k = 5
wine=read.csv("../rep_4/labeled_wine.csv",header = T,fileEncoding = "SJIS")
Nresidual<-k-nrow(wine)%%k
dummy<-as.data.frame(matrix(NA,nrow=Nresidual,ncol=ncol(wine)))
names(dummy)<-names(wine)
new.wine<-rbind(wine,dummy)
split.wine<-split(new.wine,1:k)
train.wine = rbind(split.wine[1],split.wine[2],split.wine[3])
train.wine
class(wine)
a=data.frame(split.wine)
a
dim(a)
s=data.table(split.Date())
s=rbind(data.frame(split.wine[1]),data.frame(split.wine[2]))
s=rbind(data.frame(split.wine[1]),data.frame(split.wine[2]))
q=data.frame(split.wine)
q
na.omit(split.wine)
na.exclude(split.wine)
na.omit(split.wine[5])
na.omit(q)
f=na.omit(q)
split.wine[[1]]
train.wine = rbind(data.dasplit.wine[[1]],split.wine[[2]],split.wine[[3]])
train.wine = rbind(dasplit.wine[[1]],split.wine[[2]],split.wine[[3]])
train.wine = rbind(split.wine[[1]],split.wine[[2]],split.wine[[3]])
train.wine
dim(train.wine)
train.wine = na.omit(rbind(split.wine[[1]],split.wine[[2]],split.wine[[3]],split.wine[[4]]))
train.wine
train.wine = na.omit(rbind(split.wine[-5]))
train.wine
train.wine = na.omit(rbind(split.wine[[-5]]))
train.wine = na.omit(rbind(split.wine[[-5]]))
train.wine = na.omit(rbind(split.wine[[-5]]),)
split.wine[[-5]]
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
df = data.frame(matrix(rep(NA, n), nrow=1))[numeric(0), ]
df = data.frame(matrix(rep(NA, ncol(wine)), nrow=1))[numeric(0), ]
names(df) = names(wine)
split.wine[[-5]]
df
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
df
train.wine = na.omit(df)
test.wine = na.omit(data.frame(split.wine[[4]]))
s=1.10
1
s
s=1:10
s
o=sample(s,length(s))
o
o=sample(s,length(s))
o
wine = sample(wine,nrow(wine))
wine_num = sample(1:nrow(wine)),nrow(wine))
wine_num = sample(1:nrow(wine),nrow(wine))
wine_num
length(wine_num)
wine = wine[wine_num,]
wine
Nresidual<-k-nrow(wine)%%k
dummy<-as.data.frame(matrix(NA,nrow=Nresidual,ncol=ncol(wine)))
names(dummy)<-names(wine)
new.wine<-rbind(wine,dummy)
split.wine<-split(new.wine,1:k)
source('~/R/data_scinece/rep_4/decitiontree_wine_v2.R', echo=TRUE)
train.wine
library(rpart)
res = rpart(label~.,data=train.wine,method = "class")
print(res)
plot(res,uniform = T,branch = 0.6,margin = 0.15)
han = predict(res,newdata = test.wine,type = "class")
table(han,test.wine$label)
sum(diag(table(han,test.wine$label)))/ncol(test.wine)
table(han,test.wine$label))
table(han,test.wine$label)
diag(table(han,test.wine$label))
sum(diag(table(han,test.wine$label))
)
ncol(test.wine)
sum(diag(table(han,test.wine$label)))/nrow(test.wine)
